<?xml version="1.0" encoding="utf8" standalone="yes"?>
<noit>
  <eventer>
    <config>
      <default_queue_threads>10</default_queue_threads>
      <default_ca_chain>/opt/noit/prod/etc/default-ca-chain.crt</default_ca_chain>
    </config>
  </eventer>
  <logs>
    <log name="logfile" type="file" path="/var/log/noitd.log"/>
    <console_output>
      <outlet name="stderr"/>
      <outlet name="logfile"/>
      <log name="error"/>
    </console_output>
    <debuglog>
      <log name="debug" type="file" path="/var/log/noit-debug" disabled="true"/>
    </debuglog>
    <feeds>
      <log name="feed" type="jlog" path="/var/log/noitd.feed(stratcon.circonus.net)"/>
    </feeds>
    <components>
      <error>
        <outlet name="error"/>
        <log name="error/eventer"/>
        <log name="error/ping_icmp"/>
        <log name="error/lua"/>
        <log name="error/snmp"/>
      </error>
      <debug>
        <outlet name="debug"/>
        <log name="debug/eventer" disabled="true"/>
        <log name="debug/ping_icmp" disabled="true"/>
        <log name="debug/snmp" disabled="true"/>
        <log name="debug/lua" disabled="true"/>
      </debug>
    </components>
    <feeds>
      <outlet name="feed"/>
      <log name="check">
        <outlet name="error"/>
      </log>
      <log name="status"/>
      <log name="metrics"/>
      <log name="config"/>
    </feeds>
  </logs>
  <modules directory="/opt/noit/prod/libexec/noit">
    <loader image="lua" name="lua">
      <config>
        <directory>/opt/noit/prod/libexec/noit/?.lua</directory>
      </config>
    </loader>
    <module image="selfcheck" name="selfcheck"/>
    <module image="ping_icmp" name="ping_icmp"/>
    <module image="snmp" name="snmp"/>
<!--
    <module image="snmp" name="snmptrap">
      <config>
        <community>3v3nt5</community>
      </config>
    </module>
-->
    <module image="ssh2" name="ssh2"/>
    <module image="dns" name="dns"/>
    <module image="postgres" name="postgres"/>
    <module image="mysql" name="mysql"/>
    <module loader="lua" name="varnish" object="noit.module.varnish"/>
    <module loader="lua" name="http" object="noit.module.http"/>
    <module loader="lua" name="resmon" object="noit.module.resmon"/>
    <module loader="lua" name="smtp" object="noit.module.smtp"/>
    <module loader="lua" name="tcp" object="noit.module.tcp"/>
    <generic image="check_test" name="check_test"/>
  </modules>
  <listeners>
    <sslconfig>
      <optional_no_ca>false</optional_no_ca>
      <certificate_file>/opt/napp/etc/ssl/appliance.crt</certificate_file>
      <key_file>/opt/napp/etc/ssl/appliance.key</key_file>
      <ca_chain>/opt/napp/etc/ssl/ca.crt</ca_chain>
      <crl>/opt/napp/etc/ssl/ca.crl</crl>
    </sslconfig>
    <consoles type="noit_console">
      <listener address="/tmp/noit">
        <config>
          <line_protocol>telnet</line_protocol>
        </config>
      </listener>
      <listener address="*" port="32322">
        <config>
          <line_protocol>telnet</line_protocol>
        </config>
      </listener>
      <listener address="*" port="32323" ssl="on"/>
    </consoles>
    <listener type="control_dispatch" address="*" port="43191" ssl="on">
      <config>
        <log_transit_feed_name>feed</log_transit_feed_name>
      </config>
    </listener>
  </listeners>
  <rest>
    <acl type="deny">
      <rule type="allow" cn="^(?:web\d+)$"/>
    </acl>
  </rest>
  <checks max_initial_stutter="30000" filterset="default" timeout="59000" period="60000">
  </checks>
  <filtersets>
    <filterset name="allowall">
      <rule type="allow" metric="^.+$"/>
    </filterset>
    <filterset name="default">
      <rule type="deny" metric="^(?:minimum|maximum|count)$"/>
      <rule type="allow" metric="^.+$"/>
    </filterset>
    <filterset name="ptronly">
      <rule type="allow" metric="^answer$"/>
      <rule type="deny" metric="^.+$"/>
    </filterset>
  </filtersets>
  <config_templates>
    <config id="SwitchPort">
      <oid_description>IF-MIB::ifDescr.%[name]</oid_description>
      <oid_alias>IF-MIB::ifAlias.%[name]</oid_alias>
      <oid_speed>IF-MIB::ifSpeed.%[name]</oid_speed>
      <oid_adminstatus>IF-MIB::ifAdminStatus.%[name]</oid_adminstatus>
      <oid_operstatus>IF-MIB::ifOperStatus.%[name]</oid_operstatus>
      <oid_inoctets>IF-MIB::ifInOctets.%[name]</oid_inoctets>
      <oid_outoctets>IF-MIB::ifOutOctets.%[name]</oid_outoctets>
      <oid_inerrors>IF-MIB::ifInErrors.%[name]</oid_inerrors>
      <oid_outerrors>IF-MIB::ifOutErrors.%[name]</oid_outerrors>
      <oid_indiscards>IF-MIB::ifInDiscards.%[name]</oid_indiscards>
      <oid_outdiscards>IF-MIB::ifOutDiscards.%[name]</oid_outdiscards>
      <oid_inucastpkts>IF-MIB::ifInUcastPkts.%[name]</oid_inucastpkts>
      <oid_outucastpkts>IF-MIB::ifOutUcastPkts.%[name]</oid_outucastpkts>
      <oid_inbcastpkts>IF-MIB::ifInNUcastPkts.%[name]</oid_inbcastpkts>
      <oid_outbcastpkts>IF-MIB::ifOutNUcastPkts.%[name]</oid_outbcastpkts>
    </config>
    <config id="SwitchPortX">
      <oid_description>IF-MIB::ifName.%[name]</oid_description>
      <oid_alias>IF-MIB::ifAlias.%[name]</oid_alias>
      <oid_speed>IF-MIB::ifSpeed.%[name]</oid_speed>
      <oid_adminstatus>IF-MIB::ifAdminStatus.%[name]</oid_adminstatus>
      <oid_operstatus>IF-MIB::ifOperStatus.%[name]</oid_operstatus>
      <oid_inoctets>IF-MIB::ifHCInOctets.%[name]</oid_inoctets>
      <oid_outoctets>IF-MIB::ifHCOutOctets.%[name]</oid_outoctets>
      <oid_inerrors>IF-MIB::ifInErrors.%[name]</oid_inerrors>
      <oid_outerrors>IF-MIB::ifOutErrors.%[name]</oid_outerrors>
      <oid_indiscards>IF-MIB::ifInDiscards.%[name]</oid_indiscards>
      <oid_outdiscards>IF-MIB::ifOutDiscards.%[name]</oid_outdiscards>
      <oid_inucastpkts>IF-MIB::ifHCInUcastPkts.%[name]</oid_inucastpkts>
      <oid_outucastpkts>IF-MIB::ifHCOutUcastPkts.%[name]</oid_outucastpkts>
      <oid_inbcastpkts>IF-MIB::ifHCInBroadcastPkts.%[name]</oid_inbcastpkts>
      <oid_outbcastpkts>IF-MIB::ifHCOutBroadcastPkts.%[name]</oid_outbcastpkts>
    </config>
  </config_templates>
</noit>
